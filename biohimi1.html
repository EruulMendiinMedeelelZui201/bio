<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Тоног төхөөрөмжийн бүртгэл</title>
  <style>
    /* Your existing styles remain the same */
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
      color: #333;
    }

    h1, h2 {
      text-align: center;
      color: #0056b3;
    }

    .form-container {
      width: 80%;
      max-width: 600px;
      margin: 20px auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .form-row {
      margin-bottom: 15px;
    }

    .form-row label {
      font-weight: bold;
      margin-bottom: 5px;
      display: block;
    }

    .form-row input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
    }

    .form-row button {
      background-color: #0056b3;
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .form-row button:hover {
      background-color: #003b7d;
    }

    .equipment-list {
      width: 80%;
      max-width: 600px;
      margin: 20px auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .equipment-item {
      margin-bottom: 20px;
      padding: 15px;
      background-color: #f2f2f2;
      border-radius: 4px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    .equipment-item strong {
      display: block;
      font-size: 18px;
      color: #333;
      margin-bottom: 8px;
    }

    .equipment-item span {
      display: block;
      font-size: 14px;
      color: #666;
      margin-bottom: 5px;
    }

    /* Additional CSS for Links */
    a {
      text-decoration: none;
      color: #ffffff;
      background-color: #28a745;
      padding: 15px 25px;
      font-size: 18px;
      border-radius: 8px;
      display: inline-block;
      text-align: center;
      margin-top: 20px;
      width: 100%;
      max-width: 300px;
      transition: background-color 0.3s ease, transform 0.3s ease;
    }

    a:hover {
      background-color: #218838;
      transform: scale(1.05);
    }

    a:active {
      transform: scale(0.98);
    }

    /* For Image Preview and Link */
    #image-label {
      text-align: center;
    }

    #imagePreview {
      max-width: 100%;
      margin-top: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    /* Responsive Design */
    @media screen and (max-width: 768px) {
      .form-container, .equipment-list {
        width: 95%;
      }

      a {
        font-size: 16px;
        padding: 12px 20px;
      }
    }
  </style>
</head>
<body>

  <h1>Тоног төхөөрөмжийн бүртгэл</h1>

  <div class="form-container">
    <h2>Тоног төхөөрөмжийн зориулалт</h2>
    
    <!-- Equipment Form -->
    <div class="form-row">
      <label for="name">Тоног төхөөрөмжийн нэр</label>
      <input type="text" id="name" value="LC-MS-N2 генератор">
    </div>

    <div class="form-row">
      <label for="registrationNumber">Бүртгэлийн дугаар</label>
      <input type="text" id="registrationNumber" value="BX1" readonly>
    </div>

    <div class="form-row" id="image-label">
      <label for="imageInput">Зураг</label>
      <input type="file" id="imageInput" accept="image/*">
      <img id="imagePreview" src="https://assets.onecompiler.app/42ypgxm44/42zv5phna/carbon-dioxide-incubator.webp" alt="Image preview" />
      <a href="#" class="image-link" id="imageLink">Дэлгэрэнгүй мэдээлэл</a>
    </div>

    <div class="form-row">
      <label for="brand">Марк</label>
      <input type="text" id="brand" value="Шотланд, Peak Scientific">
    </div>

    <div class="form-row">
      <label for="serialNumber">Сериал дугаар</label>
      <input type="text" id="serialNumber">
    </div>

    <div class="form-row">
      <label for="country">Үйлдвэрлэсэн орон</label>
      <input type="text" id="country">
    </div>

    <div class="form-row">
      <label for="year">Үйлдвэрлэсэн он</label>
      <input type="text" id="year">
    </div>

    <div class="form-row">
      <label for="yearOfUse">Ашиглалтад орсон он</label>
      <input type="date" id="yearOfUse" value="2014-12-09">
    </div>

    <h2>Техникийн үндсэн үзүүлэлтүүд</h2>
    
    <div class="form-row">
      <label for="capacity">Техникийн хүчин чадал</label>
      <input type="text" id="capacity" value="230V, 50/60Hz">
    </div>

    <div class="form-row">
      <label for="technicalRequirements">Техникийн шаардлага хангасан эсэх</label>
      <input type="text" id="technicalRequirements">
    </div>

    <div class="form-row">
      <label for="electricity">Цахилгаан чадлын хэмжээ</label>
      <input type="number" id="electricity" value="230">
    </div>

    <div class="form-row">
      <label for="power">Чадлын нэгж (W)</label>
      <input type="text" id="power" value="Ватт">
    </div>

    <div class="form-row">
      <label for="roomNumber">Өрөөний дугаар</label>
      <input type="text" id="roomNumber" value="106">
    </div>

    <button type="button" id="saveButton">Бүртгэх</button>
  </div>

  <div class="equipment-list" id="equipmentList">
    <h2>Бүртгэсэн Тоног Төхөөрөмжүүд</h2>
  </div>

  <!-- Link to Ажилласан цагийн бүртгэл.html -->
  <div>
    <a href="Ажилласан цагийн бүртгэл.html">Ажилласан цагийн бүртгэл</a>
  </div>

  <!-- Firebase SDK as ES Modules -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js";
    import { getDatabase, ref, set, get, onChildAdded } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCuqrFmLTPcAXnfY2Evl7V6TYoB4JuP49M",
      authDomain: "jdweq-8402c.firebaseapp.com",
      databaseURL: "https://jdweq-8402c-default-rtdb.firebaseio.com",
      projectId: "jdweq-8402c",
      storageBucket: "jdweq-8402c.firebasestorage.app",
      messagingSenderId: "669116433438",
      appId: "1:669116433438:web:be7ea5807bb575af3a45b1"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Image preview update
    document.getElementById('imageInput').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const reader = new FileReader();
      reader.onload = function() {
        document.getElementById('imagePreview').src = reader.result;
      };
      if (file) reader.readAsDataURL(file);
    });

    // Save Equipment Data
    document.getElementById('saveButton').addEventListener('click', function() {
      const name = document.getElementById('name').value;
      const registrationNumber = document.getElementById('registrationNumber').value;
      const brand = document.getElementById('brand').value;
      const serialNumber = document.getElementById('serialNumber').value;
      const country = document.getElementById('country').value;
      const year = document.getElementById('year').value;
      const yearOfUse = document.getElementById('yearOfUse').value;
      const capacity = document.getElementById('capacity').value;
      const technicalRequirements = document.getElementById('technicalRequirements').value;
      const electricity = document.getElementById('electricity').value;
      const power = document.getElementById('power').value;
      const roomNumber = document.getElementById('roomNumber').value;

      const data = {
        name,
        registrationNumber,
        brand,
        serialNumber,
        country,
        year,
        yearOfUse,
        capacity,
        technicalRequirements,
        electricity,
        power,
        roomNumber
      };

      // Only save if registration number is BX1
      if (registrationNumber === 'BX1') {
        const biohimiRef = ref(db, 'biohimi/' + registrationNumber);

        set(biohimiRef, data)
          .then(() => {
            alert('Тоног төхөөрөмжийн мэдээлэл амжилттай хадгалагдлаа!');
            loadBiohimi(); // Reload the biohimi list after saving
          })
          .catch((error) => {
            alert('Алдаа гарлаа: ' + error.message);
          });
      } else {
        alert('Зөвхөн BX2 бүртгэлийн дугаартай тоног төхөөрөмжийг хадгалж болно.');
      }
    });

    // Load Biohimi Records from Firebase
    function loadBiohimi() {
      const equipmentList = document.getElementById('equipmentList');
      equipmentList.innerHTML = '<h2>Бүртгэсэн Тоног Төхөөрөмжүүд</h2>';
      const biohimiRef = ref(db, 'biohimi');

      onChildAdded(biohimiRef, (snapshot) => {
        const equipment = snapshot.val();

        // Only display equipment with registrationNumber 'BX1'
        if (equipment.registrationNumber === 'BX1') {
          const equipmentElement = document.createElement('div');
          equipmentElement.classList.add('equipment-item');
          equipmentElement.innerHTML = ` 
            <strong>${equipment.name}</strong><br>
            <span><b>Бүртгэлийн дугаар:</b> ${equipment.registrationNumber}</span><br>
            <span><b>Марка:</b> ${equipment.brand}</span><br>
            <span><b>Сериал дугаар:</b> ${equipment.serialNumber}</span><br>
            <span><b>Үйлдвэрлэсэн орон:</b> ${equipment.country}</span><br>
            <span><b>Үйлдвэрлэсэн он:</b> ${equipment.year}</span><br>
            <span><b>Ашиглалтад орсон он:</b> ${equipment.yearOfUse}</span><br>
            <span><b>Техникийн хүчин чадал:</b> ${equipment.capacity}</span><br>
            <span><b>Техникийн шаардлага:</b> ${equipment.technicalRequirements}</span><br>
            <span><b>Цахилгаан чадал:</b> ${equipment.electricity}W</span><br>
            <span><b>Өрөөний дугаар:</b> ${equipment.roomNumber}</span><br>
          `;
          equipmentList.appendChild(equipmentElement);
        }
      });
    }

    // Load biohimi list when the page is loaded
    window.onload = function() {
      loadBiohimi();
    };
  </script>

</body>
</html>
