<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Тоног төхөөрөмжийн бүртгэл</title>
  <style>
    /* Your existing styles remain the same */
    
    /* Remove underline from links */
    a {
      text-decoration: none;
    }

    /* Optional: Add hover effect to links */
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>

  <h1>Тоног төхөөрөмжийн бүртгэл</h1>

  <div class="form-container">
    <h2>Тоног төхөөрөмжийн зориулалт</h2>
    
    <!-- Equipment Form -->
    <div class="form-row">
      <label for="name">Тоног төхөөрөмжийн нэр</label>
      <input type="text" id="name" value="LC-MS-N2 генератор">
    </div>

    <div class="form-row">
      <label for="registrationNumber">Бүртгэлийн дугаар</label>
      <input type="text" id="registrationNumber" value="123456789">
    </div>

    <div class="form-row" id="image-label">
      <label for="imageInput">Зураг</label>
      <input type="file" id="imageInput" accept="image/*">
      <img id="imagePreview" src="https://assets.onecompiler.app/42ypgxm44/42zv5phna/carbon-dioxide-incubator.webp" alt="Image preview" />
      <a href="#" class="image-link" id="imageLink">Дэлгэрэнгүй мэдээлэл</a>
    </div>

    <div class="form-row">
      <label for="brand">Марк</label>
      <input type="text" id="brand" value="Шотланд, Peak Scientific">
    </div>

    <div class="form-row">
      <label for="serialNumber">Сериал дугаар</label>
      <input type="text" id="serialNumber">
    </div>

    <div class="form-row">
      <label for="country">Үйлдвэрлэсэн орон</label>
      <input type="text" id="country">
    </div>

    <div class="form-row">
      <label for="year">Үйлдвэрлэсэн он</label>
      <input type="text" id="year">
    </div>

    <div class="form-row">
      <label for="yearOfUse">Ашиглалтад орсон он</label>
      <input type="date" id="yearOfUse" value="2014-12-09">
    </div>

    <h2>Техникийн үндсэн үзүүлэлтүүд</h2>
    
    <div class="form-row">
      <label for="capacity">Техникийн хүчин чадал</label>
      <input type="text" id="capacity" value="230V, 50/60Hz">
    </div>

    <div class="form-row">
      <label for="technicalRequirements">Техникийн шаардлага хангасан эсэх</label>
      <input type="text" id="technicalRequirements">
    </div>

    <div class="form-row">
      <label for="electricity">Цахилгаан чадлын хэмжээ</label>
      <input type="number" id="electricity" value="230">
    </div>

    <div class="form-row">
      <label for="power">Чадлын нэгж (W)</label>
      <input type="text" id="power" value="Ватт">
    </div>

    <div class="form-row">
      <label for="roomNumber">Өрөөний дугаар</label>
      <input type="text" id="roomNumber" value="106">
    </div>

    <button type="button" id="saveButton">Бүртгэх</button>
  </div>

  <div class="equipment-list" id="equipmentList">
    <h2>Бүртгэсэн Тоног Төхөөрөмжүүд</h2>
  </div>

  <!-- Link to Ажилласан цагийн бүртгэл.html -->
  <div>
    <a href="Ажилласан цагийн бүртгэл.html">Ажилласан цагийн бүртгэл</a>
  </div>

  <!-- Firebase SDK as ES Modules -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js";
    import { getDatabase, ref, set, get, onChildAdded } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCuqrFmLTPcAXnfY2Evl7V6TYoB4JuP49M",
      authDomain: "jdweq-8402c.firebaseapp.com",
      databaseURL: "https://jdweq-8402c-default-rtdb.firebaseio.com",
      projectId: "jdweq-8402c",
      storageBucket: "jdweq-8402c.firebasestorage.app",
      messagingSenderId: "669116433438",
      appId: "1:669116433438:web:be7ea5807bb575af3a45b1"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Image preview update
    document.getElementById('imageInput').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const reader = new FileReader();
      reader.onload = function() {
        document.getElementById('imagePreview').src = reader.result;
      };
      if (file) reader.readAsDataURL(file);
    });

    // Save Equipment Data
    document.getElementById('saveButton').addEventListener('click', function() {
      const name = document.getElementById('name').value;
      const registrationNumber = document.getElementById('registrationNumber').value;
      const brand = document.getElementById('brand').value;
      const serialNumber = document.getElementById('serialNumber').value;
      const country = document.getElementById('country').value;
      const year = document.getElementById('year').value;
      const yearOfUse = document.getElementById('yearOfUse').value;
      const capacity = document.getElementById('capacity').value;
      const technicalRequirements = document.getElementById('technicalRequirements').value;
      const electricity = document.getElementById('electricity').value;
      const power = document.getElementById('power').value;
      const roomNumber = document.getElementById('roomNumber').value;

      const data = {
        name,
        registrationNumber,
        brand,
        serialNumber,
        country,
        year,
        yearOfUse,
        capacity,
        technicalRequirements,
        electricity,
        power,
        roomNumber
      };

      const equipmentRef = ref(db, 'equipment/' + registrationNumber);

      set(equipmentRef, data)
        .then(() => {
          alert('Тоног төхөөрөмжийн мэдээлэл амжилттай хадгалагдлаа!');
          loadEquipment(); // Reload the equipment list after saving
        })
        .catch((error) => {
          alert('Алдаа гарлаа: ' + error.message);
        });
    });

    // Load Equipment Records from Firebase
    function loadEquipment() {
      const equipmentList = document.getElementById('equipmentList');
      equipmentList.innerHTML = '<h2>Бүртгэсэн Тоног Төхөөрөмжүүд</h2>';
      const equipmentRef = ref(db, 'equipment');

      onChildAdded(equipmentRef, (snapshot) => {
        const equipment = snapshot.val();
        const equipmentElement = document.createElement('div');
        equipmentElement.classList.add('equipment-item');
        equipmentElement.innerHTML = ` 
          <strong>${equipment.name}</strong><br>
          <span><b>Бүртгэлийн дугаар:</b> ${equipment.registrationNumber}</span><br>
          <span><b>Марка:</b> ${equipment.brand}</span><br>
          <span><b>Сериал дугаар:</b> ${equipment.serialNumber}</span><br>
          <span><b>Үйлдвэрлэсэн орон:</b> ${equipment.country}</span><br>
          <span><b>Үйлдвэрлэсэн он:</b> ${equipment.year}</span><br>
          <span><b>Ашиглалтад орсон он:</b> ${equipment.yearOfUse}</span><br>
          <span><b>Техникийн хүчин чадал:</b> ${equipment.capacity}</span><br>
          <span><b>Техникийн шаардлага:</b> ${equipment.technicalRequirements}</span><br>
          <span><b>Цахилгаан чадал:</b> ${equipment.electricity}W</span><br>
          <span><b>Өрөөний дугаар:</b> ${equipment.roomNumber}</span><br>
        `;
        equipmentList.appendChild(equipmentElement);
      });
    }

    // Load equipment list when the page is loaded
    window.onload = function() {
      loadEquipment();
    };
  </script>

</body>
</html>
